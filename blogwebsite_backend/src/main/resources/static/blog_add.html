<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--    <meta charset="UTF-8" />-->
<!--    <title>Create New Blog</title>-->
<!--    <style>-->
<!--        body {-->
<!--          font-family: Arial;-->
<!--          padding: 20px;-->
<!--        }-->
<!--        .header {-->
<!--          display: flex;-->
<!--          justify-content: space-between;-->
<!--          align-items: center;-->
<!--        }-->
<!--        h1 {-->
<!--          color: #4B0082;-->
<!--        }-->
<!--        .logout-button {-->
<!--          background-color: #f44336;-->
<!--          color: white;-->
<!--          padding: 8px 16px;-->
<!--          border: none;-->
<!--          border-radius: 5px;-->
<!--          cursor: pointer;-->
<!--        }-->
<!--        .blog-form input, .blog-form textarea {-->
<!--          display: block;-->
<!--          margin-bottom: 10px;-->
<!--          padding: 8px;-->
<!--          width: 300px;-->
<!--        }-->
<!--        .blog-cards {-->
<!--          display: flex;-->
<!--          flex-wrap: wrap;-->
<!--          gap: 20px;-->
<!--          margin-top: 30px;-->
<!--        }-->
<!--        .card {-->
<!--          border: 1px solid #ccc;-->
<!--          padding: 15px;-->
<!--          border-radius: 8px;-->
<!--          width: 250px;-->
<!--          box-shadow: 2px 2px 5px rgba(0,0,0,0.1);-->
<!--          cursor: pointer;-->
<!--        }-->
<!--    </style>-->
<!--</head>-->
<!--<body>-->

<!--<div class="header">-->
<!--    <h1>Create New Blog</h1>-->
<!--    <button onclick="logout()" class="logout-button">Logout</button>-->
<!--</div>-->

<!--<div class="blog-form">-->
<!--    <input type="text" id="title" placeholder="Title" />-->
<!--    <textarea id="content" placeholder="Content"></textarea>-->
<!--    <input type="text" id="words" placeholder="Words (comma separated)" />-->
<!--    <button onclick="submitBlog()">Submit</button>-->
<!--</div>-->

<!--<h2>Your Blogs</h2>-->
<!--<div class="blog-cards" id="blogContainer"></div>-->

<!--<script>-->
<!--    const email = sessionStorage.getItem('userEmail');-->
<!--    const name= sessionStorage.getItem('userName');-->
<!--    if (!email) {-->
<!--      alert("Unauthorized. Please login.");-->
<!--      window.location.href = "/login.html";-->
<!--    }-->

<!--    function loadBlogs() {-->
<!--      fetch(`http://localhost:9090/getblogsbyemail/${email}`)-->
<!--        .then(res => res.json())-->
<!--        .then(data => {-->
<!--          const container = document.getElementById("blogContainer");-->
<!--          container.innerHTML = "";-->

<!--          if (!data || !data.blog || data.blog.length === 0) {-->
<!--            container.innerHTML = "<p>No blogs found for your account.</p>";-->
<!--            return;-->
<!--          }-->

<!--          data.blog.forEach(blogArr => {-->
<!--            const [title, content, blog_words] = blogArr;-->
<!--            const card = document.createElement("div");-->
<!--            card.className = "card";-->
<!--            card.onclick = () => {-->
<!--              window.location.href = `/blog_view.html?title=${encodeURIComponent(title)}`;-->
<!--            };-->
<!--            card.innerHTML = `-->
<!--              <h3>${title}</h3>-->
<!--              <p>${content.slice(0, 50)}...</p>-->
<!--              <small>${blog_words}</small>-->
<!--            `;-->
<!--            container.appendChild(card);-->
<!--          });-->
<!--        });-->
<!--    }-->

<!--    function submitBlog() {-->
<!--      const blog = {-->
<!--        title: document.getElementById("title").value,-->
<!--        content: document.getElementById("content").value,-->
<!--        blog_words: document.getElementById("words").value,-->
<!--        email: email,-->
<!--        name:name-->
<!--      };-->

<!--      fetch("http://localhost:9090/addblog", {-->
<!--        method: "POST",-->
<!--        headers: { "Content-Type": "application/json" },-->
<!--        body: JSON.stringify(blog)-->
<!--      }).then(response => {-->
<!--        if (response.ok) {-->
<!--          alert("Blog created!");-->
<!--          loadBlogs();-->
<!--    }-->
<!--        else {-->
<!--              alert("A blog with this title already exists. Please choose a different title.");-->
<!--        }-->
<!--      });-->
<!--    }-->

<!--    function logout() {-->
<!--      sessionStorage.clear();-->
<!--      window.location.href = "/index.html";-->
<!--    }-->

<!--    window.onload = loadBlogs;-->
<!--</script>-->
<!--</body>-->
<!--</html>-->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Create New Blog</title>
    <style>
        body {
          font-family: Arial;
          padding: 20px;
        }

        .header {
          display: flex;
          justify-content: space-between;
          align-items: center;
        }

        h1 {
          color: #4B0082;
        }

        .logout-button {
          background-color: #f44336;
          color: white;
          padding: 8px 16px;
          border: none;
          border-radius: 5px;
          cursor: pointer;
        }

        .blog-form input, .blog-form textarea {
          display: block;
          margin-bottom: 10px;
          padding: 8px;
          width: 300px;
        }

        .blog-cards {
          display: flex;
          flex-wrap: wrap;
          gap: 20px;
          margin-top: 30px;
        }

        .card {
  background-color: #f5f7ff;
  border-radius: 15px;
  padding: 20px;
  width: 250px;
  position: relative;
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  transition: transform 0.2s ease, box-shadow 0.2s ease;
  cursor: pointer;
}

.card:hover,
.card:active {
  transform: translateY(-5px) scale(1.02);
  box-shadow: 0 8px 16px rgba(0,0,0,0.2);
}


        .card h3 {
          margin-top: 0;
        }

        .edit-icon, .delete-icon {
          background: none;
          border: none;
          font-size: 18px;
          cursor: pointer;
        }

        .edit-icon {
          position: absolute;
          top: 10px;
          right: 10px;
          color: #1f4f91;
        }

        .delete-icon {
          position: absolute;
          bottom: 10px;
          right: 10px;
          color: #e53935;
        }
    </style>
</head>
<body>

<div class="header">
    <h1>Create New Blog</h1>
    <button onclick="logout()" class="logout-button">Logout</button>
</div>

<div class="blog-form">
    <input type="text" id="title" placeholder="Title" />
    <textarea id="content" placeholder="Content"></textarea>
    <input type="text" id="words" placeholder="Words (comma separated)" />
    <button onclick="submitBlog()">Submit</button>
</div>

<h2>Your Blogs</h2>
<div class="blog-cards" id="blogContainer"></div>

<script>
    const email = sessionStorage.getItem('userEmail');
    const name = sessionStorage.getItem('userName');

    if (!email) {
      alert("Unauthorized. Please login.");
      window.location.href = "/login.html";
    }

    let editMode = false;
    let originalTitle = "";

    function loadBlogs() {
      fetch(`http://localhost:9090/getblogsbyemail/${email}`)
        .then(res => res.json())
        .then(data => {
          const container = document.getElementById("blogContainer");
          container.innerHTML = "";

          if (!data || !data.blog || data.blog.length === 0) {
            container.innerHTML = "<p>No blogs found for your account.</p>";
            return;
          }

          data.blog.forEach(blogArr => {
            const [title, content, blog_words] = blogArr;
            const card = document.createElement("div");
            card.onclick = () => {
                 window.location.href = `/blog_view.html?title=${encodeURIComponent(title)}`;
             };

            card.innerHTML = `
              <button class="edit-icon" title="Edit" onclick="editBlog(event, '${title}', \`${content}\`, '${blog_words}')">‚úèÔ∏è</button>
              <h3>${title}</h3>
              <p>${content.slice(0, 50)}...</p>
              <small>${blog_words}</small>
              <button class="delete-icon" title="Delete" onclick="deleteBlog('${email}','${title}')">üóëÔ∏è</button>
            `;
              card.className = "card";

            container.appendChild(card);
          });
        });
    }

    function submitBlog() {
      const title = document.getElementById("title").value;
      const content = document.getElementById("content").value;
      const words = document.getElementById("words").value;

      const blog = {
        title,
        content,
        blog_words: words,
        email,
        name
      };

      const url = editMode
        ? `http://localhost:9090/updateblog/${email}/${originalTitle}`
        : "http://localhost:9090/addblog";

      fetch(url, {
        method: editMode ? "PUT" : "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(blog)
      }).then(response => {
        if (response.ok) {
          alert(editMode ? "Blog updated!" : "Blog created!");
          document.getElementById("title").value = "";
          document.getElementById("content").value = "";
          document.getElementById("words").value = "";
          editMode = false;
          loadBlogs();
        } else {
          alert("Error! this title name already exists");
        }
      });
    }

    function editBlog(event, title, content, blog_words) {
      event.stopPropagation();
      document.getElementById("title").value = title;
      document.getElementById("content").value = content;
      document.getElementById("words").value = blog_words;
      editMode = true;
      originalTitle = title;
    }

    function deleteBlog(email,title) {
        event.stopPropagation();
      if (!confirm(" you want to delete this blog?")) return;
      fetch(`http://localhost:9090/deleteblog/${email}/${title}`, {
        method: "DELETE"
      }).then(res => {
        if (res.ok) {
          alert("Blog deleted.");
          loadBlogs();
        } else {
          alert("Failed to delete blog.");
        }
      });
    }

    function logout() {
      sessionStorage.clear();
      window.location.href = "/index.html";
    }

    window.onload = loadBlogs;
</script>

</body>
</html>
